<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="–î–∞—à–±–æ—Ä–¥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤–µ—Å–∞, BMI –∏ –ö–ë–ñ–£ (–∫–∞–ª–æ—Ä–∏–π, –±–µ–ª–∫–æ–≤, –∂–∏—Ä–æ–≤, —É–≥–ª–µ–≤–æ–¥–æ–≤)">
  <title>–ö–ë–ñ–£ –î–∞—à–±–æ—Ä–¥</title>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <!-- Flatpickr -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/dark.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ru.js"></script>

  <!-- Styles -->
  <link rel="stylesheet" href="index.css">
</head>

<body>
  <div class="dashboard">
    <header class="dashboard-header">

      <button class="settings-btn" id="openSettings" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">
        ‚öôÔ∏è
      </button>
    </header>

    <!-- Loading State -->
    <div class="loading-overlay" id="loadingOverlay">
      <div class="loading-spinner"></div>
      <p>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
    </div>

    <!-- Error State -->
    <div class="error-message" id="errorMessage" style="display: none;">
      <div class="error-content">
        <span class="error-icon">‚ö†Ô∏è</span>
        <p id="errorText">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</p>
        <button onclick="openSettingsPanel()">–û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
      </div>
    </div>

    <!-- Body Metrics Section -->
    <section class="section" id="body-metrics">
      <div class="section-header">
        <h2 class="section-title">‚öñÔ∏è –í–µ—Å –∏ BMI</h2>
        <div class="date-range-picker">
          <button class="date-range-btn" id="metricsDateRangeBtn">
            <span class="date-range-text" id="metricsDateRangeText">–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥</span>
            <span id="metricsDaysCount" class="days-count"></span>
          </button>
          <button class="date-reset-btn" id="metricsDateResetBtn" title="–í–µ—Å—å –ø–µ—Ä–∏–æ–¥">√ó</button>
          <input type="text" id="metricsDateRange" style="position: absolute; opacity: 0; pointer-events: none;">
        </div>
      </div>
      <div class="charts-row">
        <!-- Weight Chart -->
        <div class="chart-container">
          <div class="chart-title">üìâ –î–∏–Ω–∞–º–∏–∫–∞ –≤–µ—Å–∞</div>
          <div class="chart-wrapper">
            <canvas id="weightChart"></canvas>
          </div>
        </div>

        <!-- BMI Chart -->
        <div class="chart-container">
          <div class="chart-title">üìä –î–∏–Ω–∞–º–∏–∫–∞ BMI</div>
          <div class="chart-wrapper">
            <canvas id="bmiChart"></canvas>
          </div>

        </div>
      </div>
    </section>

    <!-- Nutrition & Macros Section -->
    <section class="section" id="nutrition">
      <div class="section-header sticky-header">
        <h2 class="section-title">üî• –ö–∞–ª–æ—Ä–∏–∏ –∏ –º–∞–∫—Ä–æ–Ω—É—Ç—Ä–∏–µ–Ω—Ç—ã</h2>
        <div class="date-range-picker">
          <div class="view-toggle" id="globalNutritionToggle">
            <button class="view-btn active" data-view="daily">–î–Ω–∏</button>
            <button class="view-btn" data-view="weekly">–ù–µ–¥–µ–ª–∏</button>
          </div>
          <button class="date-range-btn" id="nutritionDateRangeBtn">
            <span class="date-range-text" id="nutritionDateRangeText">–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥</span>
            <span id="nutritionDaysCount" class="days-count"></span>
          </button>
          <button class="date-reset-btn" id="nutritionDateResetBtn" title="–í–µ—Å—å –ø–µ—Ä–∏–æ–¥">√ó</button>
          <input type="text" id="nutritionDateRange" style="position: absolute; opacity: 0; pointer-events: none;">
        </div>
      </div>

      <!-- Calories Sub-section -->
      <div class="sub-section">
        <div class="calorie-dashboard-grid">
          <div class="main-column">
            <div class="chart-container">
              <div class="chart-header">
                <div class="chart-title" id="calorieChartTitle">–î–∏–Ω–∞–º–∏–∫–∞ –∫–∞–ª–æ—Ä–∏–π</div>
              </div>
              <div class="calorie-chart-wrapper">
                <canvas id="calorieChart"></canvas>
              </div>
            </div>
          </div>
          <div class="sidebar-column">
            <div class="chart-container">
              <div class="chart-title" id="distributionChartTitle">% –¥–Ω–µ–π –ø–æ –∑–æ–Ω–∞–º</div>
              <div class="distribution-wrapper vertical">
                <canvas id="distributionChart"></canvas>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Macros Sub-section -->
      <div class="sub-section" id="macros">
        <div class="charts-row-3">
          <!-- Proteins -->
          <div class="macro-section">
            <div class="chart-container">
              <div class="chart-header">
                <div class="chart-title" id="proteinsChartTitle">–ë–µ–ª–∫–∏</div>
              </div>
              <div class="chart-wrapper">
                <canvas id="proteinsChart"></canvas>
              </div>
            </div>
            <div class="macro-card gauge-card proteins">
              <div class="gauge-title">
                <span id="proteinsGaugeTitle">–£—Å–ø–µ—à–Ω—ã–µ –¥–Ω–∏</span>
                <span class="info-icon" id="proteinsGaugeTooltip" data-tooltip="–î–Ω–∏ –±–µ–∑ –Ω–µ–¥–æ–±–æ—Ä–∞ –ø–æ –±–µ–ª–∫—É">i</span>
              </div>
              <div class="gauge-container">
                <canvas id="proteinsGaugeChart"></canvas>
              </div>
              <div id="proteinsInsight" class="gauge-insight"></div>
            </div>
          </div>

          <!-- Fats -->
          <div class="macro-section">
            <div class="chart-container">
              <div class="chart-header">
                <div class="chart-title" id="fatsChartTitle">–ñ–∏—Ä—ã</div>
              </div>
              <div class="chart-wrapper">
                <canvas id="fatsChart"></canvas>
              </div>
            </div>
            <div class="macro-card gauge-card fats">
              <div class="gauge-title">
                <span id="fatsGaugeTitle">–£—Å–ø–µ—à–Ω—ã–µ –¥–Ω–∏</span>
                <span class="info-icon" id="fatsGaugeTooltip" data-tooltip="–î–Ω–∏ –±–µ–∑ –ø–µ—Ä–µ–±–æ—Ä–∞ –ø–æ –∂–∏—Ä–∞–º">i</span>
              </div>
              <div class="gauge-container">
                <canvas id="fatsGaugeChart"></canvas>
              </div>
              <div id="fatsInsight" class="gauge-insight"></div>
            </div>
          </div>

          <!-- Carbs -->
          <div class="macro-section single">
            <div class="chart-container">
              <div class="chart-header">
                <div class="chart-title" id="carbsChartTitle">–£–≥–ª–µ–≤–æ–¥—ã</div>
              </div>
              <div class="chart-wrapper">
                <canvas id="carbsChart"></canvas>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Settings Modal -->
  <div class="modal-overlay" id="settingsModal">
    <div class="modal">
      <div class="modal-header">
        <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
        <button class="modal-close" id="closeSettings">√ó</button>
      </div>

      <div class="modal-body">


        <!-- BMI Target -->
        <div class="settings-group">
          <label class="settings-label">üéØ –¶–µ–ª—å BMI</label>
          <input type="number" class="settings-input" id="settingBmiTarget" value="25" step="0.1" min="15" max="40">
        </div>

        <hr class="settings-divider">

        <!-- Macro Targets -->
        <div class="settings-group">
          <label class="settings-label">üçΩÔ∏è –î–Ω–µ–≤–Ω—ã–µ –ø–ª–∞–Ω—ã –º–∞–∫—Ä–æ–Ω—É—Ç—Ä–∏–µ–Ω—Ç–æ–≤ (–≥)</label>
          <div class="settings-macro-grid">
            <div class="settings-field">
              <span>–ë–µ–ª–∫–∏</span>
              <input type="number" class="settings-input small" id="settingProteins" placeholder="–≥">
            </div>
            <div class="settings-field">
              <span>–ñ–∏—Ä—ã</span>
              <input type="number" class="settings-input small" id="settingFats" placeholder="–≥">
            </div>
            <div class="settings-field">
              <span>–£–≥–ª–µ–≤–æ–¥—ã</span>
              <input type="number" class="settings-input small" id="settingCarbs" placeholder="–≥">
            </div>
          </div>
        </div>

        <hr class="settings-divider">

        <!-- Calorie Zones -->
        <div class="settings-group">
          <label class="settings-label">üî• –ì—Ä–∞–Ω–∏—Ü—ã –∑–æ–Ω –∫–∞–ª–æ—Ä–∏–π (–∫–∫–∞–ª)</label>
          <div class="zone-setting">
            <div class="zone-color" style="background: #FF6B6B;"></div>
            <span>–ù–µ–∑–¥–æ—Ä–æ–≤—ã–π –¥–µ—Ñ–∏—Ü–∏—Ç –¥–æ</span>
            <input type="number" class="settings-input small" id="settingZoneUnhealthyDeficit" value="1700">
          </div>
          <div class="zone-setting">
            <div class="zone-color" style="background: #ABEBC6;"></div>
            <span>–ë—ã—Å—Ç—Ä–æ–µ –ø–æ—Ö—É–¥–µ–Ω–∏–µ –¥–æ</span>
            <input type="number" class="settings-input small" id="settingZoneFastLoss" value="1900">
          </div>
          <div class="zone-setting">
            <div class="zone-color" style="background: #58D68D;"></div>
            <span>–ó–¥–æ—Ä–æ–≤–æ–µ –ø–æ—Ö—É–¥–µ–Ω–∏–µ –¥–æ</span>
            <input type="number" class="settings-input small" id="settingZoneHealthyLoss" value="2200">
          </div>
          <div class="zone-setting">
            <div class="zone-color" style="background: #ABEBC6;"></div>
            <span>–ú–µ–¥–ª–µ–Ω–Ω–æ–µ –ø–æ—Ö—É–¥–µ–Ω–∏–µ –¥–æ</span>
            <input type="number" class="settings-input small" id="settingZoneSlowLoss" value="2400">
          </div>
          <div class="zone-setting">
            <div class="zone-color" style="background: #FFB74D;"></div>
            <span>–ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –≤–µ—Å–∞ –¥–æ</span>
            <input type="number" class="settings-input small" id="settingZoneMaintenance" value="2600">
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="cancelSettings">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn btn-primary" id="saveSettings">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="data.js"></script>
  <script src="charts.js"></script>
  <script src="app.js"></script>
</body>

</html>